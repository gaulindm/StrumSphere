{% load static %}

<div class="content-section">
        {% if user.is_authenticated %}<h3>Modify</h3>(must be logged in<br> 
    <a class="btn btn-secondary btn-sm-mt-1 mb-1" href="{% url 'song-update' score.id %}">Update</a>
        {% endif%}

    <input type="hidden" name="csrfmiddlewaretoken" value="{{ csrf_token }}">
    <p class='text-muted'>
    <ul class="list-group">
        <li class="list-group-item list-group-item-heavy"><h3>Control Panel</h3>
        </li>
        <label for="transpose-select">Transpose:</label>
        <P>The feature is temporarily not available </P>
        <select id="transpose-select" class="form-control">
            <option value="0">Original Key</option>
            <option value="-7">-7 semitone</option>
            <option value="-6">-6 semitone</option>
            <option value="-5">-5 semitone</option>
            <option value="-4">-4 semitone</option>
            <option value="-3">-3 semitone</option>
            <option value="-2">-2 semitone</option>
            <option value="-1">-1 semitone</option>
            <option value="1">+1 semitone</option>
            <option value="2">+2 semitone</option>
            <option value="3">+3 semitone</option>
            <option value="4">+4 semitone</option>
            <option value="5">+5 semitone</option>
            <option value="6">+6 semitone</option>
            <option value="7">+7 semitone</option>
        </select>
        
        <button id="update-preview" class="btn btn-primary">Update Print Preview</button>
        </li>
        <!-- Lyrics and Chords Appearance -->
        <li class="list-group-item list-group-item-heavy">
            <strong>Lyrics and Chords Appearance</strong>
            <div class="control-panel mt-12 d-flex flex-wrap align-items-center">
                <!-- Font Size -->
                <div class="me-3">
                    {% if user.is_authenticated and user.is_superuser %}
                    <a href="{% url 'edit_formatting' score.id %}" class="btn btn-warning">Edit Song Formatting</a>
                {% elif user.is_authenticated and user.groups.all|length > 0 and "Power Users" in user.groups.all|join:", " %}
                    <a href="{% url 'edit_formatting' score.id %}" class="btn btn-warning">Edit Song Formatting</a>
                {% else %}
                    <p>Please send an email to gaulindm@gmail.com to request Power User permission.</p>
                {% endif %}
                </div>
        </li>

      
      
    </ul>

</div>
<div>
{% if score.metadata.youtube %}
    <p>YouTube Link: <a href="{{ score.metadata.youtube }}" target="_blank">Watch on YouTube</a></p>
    <button onclick="playSong('{{ score.metadata.youtube }}')">Play Video</button>
</div>

<div id="youtube-player-container" style="margin-top: 20px;"></div>
{% else %}
    <p>No YouTube video available for this song.</p>
{% endif %}

</div>
<script>
document.addEventListener("DOMContentLoaded", function() {

    function refreshPDFPreview() {
    console.log("üîÑ Refreshing PDF preview...");

    fetch(`/format_song/{{ score.id }}/`)  // Adjust if needed
    .then(response => response.json())
    .then(data => {
        document.getElementById("song-content").innerHTML = data.html;
        console.log("‚úÖ PDF preview updated!");
    })
    .catch(error => console.error("‚ùå PDF Refresh Error:", error));
}



</script>